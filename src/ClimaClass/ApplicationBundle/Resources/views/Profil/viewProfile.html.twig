{%extends "ClimaClassApplicationBundle::layout.html.twig"%}

{% block title %}Profile of {{class.class}}{% endblock %}

{% block content %}	
    <div class="repport col-xs-12">
        <div class="row">
            <div class="col-xs-12 green" style="margin-bottom: 10px;">
                <div class="col-xs-9"><h1><img src="{{asset('bundles/climaclassapplication/images/theme/School_32.png')}}"> Profile {{class.class}}</h1></div>
                <div class="col-xs-3">
                    {%if app.user is not null%}{%if app.user.id != id %}				
                        <p><img src="{{asset('bundles/climaclassapplication/images/theme/Message_Closed_Envelope_32.png')}}"> <a class="send" href="{{path('new_conversation',{'id_recipient':class.id})}}">Send a message</a></p>
                    {%endif%}{%endif%}
                </div>
            </div>
            <div class="col-xs-12">
                <div class="row">
                    <div class="col-md-6">
                        <div class="blue col-xs-12">
                            <h3><img src="{{asset('bundles/climaclassapplication/images/theme/Locked_padlock_32.png')}}"> School info</h3>
                        </div>
                        <div class="col-xs-12 grey">
							<div class="col-xs-2" style="margin-top: 10px;">
								<img src="{{asset('bundles/climaclassapplication/images/theme/Image_Archive_80.png')}}">
							</div>
							<div class="col-xs-10">
								<div class="col-xs-6">	
									<select class="form-control greyInput" multiple disabled style="cursor: default; margin-bottom: 10px;">
										<option style="color: #00a8ff">{{class.mainLanguage.language}}</option>
										{%for language in class.languages%}
											{% if language.language != class.mainLanguage.language%}
												<option>{{language.language}}</option>
											{%endif%}
										{%endfor%}
									</select>
								</div>
								<div class="col-xs-6">
									<input type="text" class="form-control greyInput" value="{{class.lastname}}" disabled style="cursor: default;">
								</div>
								<div class="col-xs-6">	
									<input type="text" class="form-control greyInput" value="{{class.firstname}}" disabled style="cursor: default;">
								</div>
							</div>
							<div class="col-md-12" style="margin-bottom: 10px; margin-top: 10px;">
								<textarea class="form-control" rows="3" disabled style="cursor: default;">{{class.description}}</textarea>
							</div>
                        </div>
                    </div>
                    <div class="col-md-6"><div class="col-xs-12" id="gmap" style="height: 250px"></div></div>
                </div>
            </div>

            <div class="col-xs-12">
                <div id="temperatureGraph"></div>
                <div id="rainGraph"></div>
                <div id="windGraph"></div>
            </div>

            {%for report in pagination%}
                <div class="col-sm-6 col-md-4">
                    <div class="thumbnail">
                        <div class="col-xs-12 cl-indicator">
                            <div class="col-xs-4">
                                <img src="{{asset('bundles/climaclassapplication/images/theme/Science_Thermometer_16.png')}}">
                                {%if report.lastMeasure is not null%}
                                    {{report.lastMeasure.temperature}}°C
                                {%else%}
                                    -
                                {%endif%}
                            </div>
                            <div class="col-xs-4">
                                <img src="{{asset('bundles/climaclassapplication/images/theme/Wind_sign_16.png')}}">
                                {%if report.lastMeasure is not null%}
                                    {{report.lastMeasure.windSpeed}} km/h
                                {%else%}
                                    -
                                {%endif%} 
                            </div>
                        </div>
                        <img src="{{asset('bundles/climaclassapplication/images/theme/thumbnail.png')}}">
                        <div class="caption">
                            <h3 id="thumbnail-label">{{report.title}}<a class="anchorjs-link" href="#thumbnail-label"><span class="anchorjs-icon"></span></a></h3>
                            <p>{{report.content|raw}}</p>
                        </div>
                        <div class="col-xs-12 square">
                            <div class="col-xs-6 col-xs-offset-3">
                                <p>
                                <div class="button"><a href="{{path('report',{'id':report.id})}}">Read</a></div>
                                </p>
                            </div>	
                        </div>
                    </div>
                </div> 
            {%endfor%}

            <div class="navigation">
                {{ knp_pagination_render(pagination) }}
            </div>
        </div>
    {% endblock %}

    {% block javascripts %}
        {{parent()}}
        <script src="https://maps.googleapis.com/maps/api/js"></script>
        <script src="{{asset('bundles/climaclassapplication/js/highcharts-custom.js')}}"></script>
        <script>
                    google.maps.event.addDomListener(window, 'load', gMapInitialize);
                    function gMapInitialize(){
                    var mapCanvas = document.getElementById("gmap");
                            var markers = [];
                            var mapOptions = {
                            center: new google.maps.LatLng({{class.latitude}}, {{class.longitude}}),
                                    zoom: 13,
                                    mapTypeId: google.maps.MapTypeId.ROADMAP
                            };
                            var map = new google.maps.Map(mapCanvas, mapOptions);
                            var marker = new google.maps.Marker({
                            map: map,
                                    title: "{{class.class}}",
                                    position: new google.maps.LatLng({{class.latitude}}, {{class.longitude}})
                            });
                    }
        </script>
        <script type="text/javascript">
            $(function () {
				$('#temperatureGraph').css("height", "300px").highcharts({
					title: {
						text: 'Temperature',
						x: - 20 //center
					},
					xAxis: {
						categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun','Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
					},
					yAxis: {
						title: {
							text: 'Temperature (°C)'
						}
					},
					tooltip: {
						valueSuffix: '°C'
					},
					legend: {
						layout: 'vertical',
						align: 'right',
						verticalAlign: 'middle',
						borderWidth: 0
					},
					series: [{
						name: 'Tokyo',
						data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]
					}]
				});
				$('#rainGraph').css("height", "300px").highcharts({
					title: {
						text: 'Rain level',
						x: - 20 //center
					},
					xAxis: {
						categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun','Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
					},
					yAxis: {
						title: {
							text: 'Rain level (mm)'
						}
					},
					tooltip: {
						valueSuffix: 'mm'
					},
					legend: {
						layout: 'vertical',
						align: 'right',
						verticalAlign: 'middle',
						borderWidth: 0
					},
					series: [{
						name: 'Tokyo',
						data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]
					}]
				});
				$('#windGraph').css("height", "300px").highcharts({
					title: {
						text: 'Wind speed and direction',
						x: - 20 //center
					},
					xAxis: {
						categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun','Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
					},
					yAxis: {
						title: {
							text: 'Speed (km/h)'
						}
					},
					tooltip: {
						valueSuffix: 'km/h'
					},
					legend: {
						layout: 'vertical',
						align: 'right',
						verticalAlign: 'middle',
						borderWidth: 0
					},
					series: [{
						name: 'Tokyo',
						data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]
					}]
				});
            });
        </script>
    {% endblock %}